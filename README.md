# Seven Streams' Ticket SystemğŸš‹
è¿™é‡Œæ˜¯ç‰å·çš„æ•°æ®ç»“æ„å¤§ä½œä¸šã€‚

æœ¬æ¬¡ä½œä¸šè¦æ±‚å®ç°ä¸€ä¸ªç±»ä¼¼äº [12306](https://www.12306.cn/) çš„ç«è½¦ç¥¨è®¢ç¥¨ç³»ç»Ÿï¼Œè¯¥ç³»ç»Ÿå‘ç”¨æˆ·æä¾›è´­ç¥¨ä¸šåŠ¡ç›¸å…³åŠŸèƒ½ï¼ŒåŒ…æ‹¬è½¦ç¥¨æŸ¥è¯¢ã€è´­ç¥¨ã€è®¢å•æ“ä½œç­‰ï¼Œä»¥åŠå‘ç®¡ç†å‘˜æä¾›åå°ç®¡ç†åŠŸèƒ½ã€‚

å¦‚æœå¤§å®¶çœ‹å¾—èµ·æˆ‘å†™çš„è¿™ä¸€å¨ï¼Œ~å¹¶ä¸”ä»æˆ‘è¿™é‡Œå­¦åˆ°ä»€ä¹ˆï¼Œé‚£æ˜¯æˆ‘çš„è£å¹¸ã€‚ğŸ˜€~(å­¦ä¸åˆ°ä»€ä¹ˆï¼Œæ…¢å¾—ä¸€å¨ï¼‰

~(å¦‚æœèƒ½å¤Ÿç‚¹ä¸ªstarå°±æ›´å¥½äº†XD)ğŸ˜~

ä½†è¿˜æ˜¯è¯·ä¸è¦**ç›´æ¥æŠ„**æˆ‘çš„ğŸ´ã€‚
## ä»£ç æ–‡ä»¶ç»“æ„
- ğŸ“`src/`
  - ğŸ“„`main.cpp`
  - ğŸ“„`account.cpp`
  - ğŸ“„`order.cpp`
  - ğŸ“„`train.cpp`
  - ğŸ“„`utility.cpp`
- ğŸ“`include/`
  - ğŸ“„`account.hpp`
  - ğŸ“„`BPT.hpp`
  - ğŸ“„`list.hpp`
  - ğŸ“„`map.hpp`
  - ğŸ“„`memoryriver.hpp`
  - ğŸ“„`order.hpp`
  - ğŸ“„`priority_queue.hpp`
  - ğŸ“„`train.hpp`
  - ğŸ“„`utility.hpp`
  - ğŸ“„`vector.hpp`
- ğŸ“„`README.md`
- ğŸ“„`.gitignore`
- ğŸ“„`CMakeLists.txt`

## ä»£ç æ–‡ä»¶æ¦‚è¿°

åœ¨BPT.hpp, list.hpp, map.hpp, priority_queue.hpp, vector.hppä¸­ï¼Œåˆ†åˆ«æä¾›äº†ä¸€ä¸ªB+æ ‘ç±»ï¼Œé“¾è¡¨ç±»ï¼Œæ˜ å°„ç±»ï¼Œä¼˜å…ˆé˜Ÿåˆ—ç±»ï¼Œçº¿æ€§è¡¨ç±»ã€‚

å…¶ä¸­ï¼Œlist, map, priority_queue, vectorçš„è¡Œä¸ºä¸Cppæ ‡å‡†åº“ç›¸è¿‘ã€‚ä¸ä¿è¯è¿­ä»£å™¨çš„è¡Œä¸ºä¸C++ä¸€è‡´ã€‚

BPTç±»è¦æ±‚ä»¥ä¸¤ä¸ªULLå“ˆå¸Œå€¼ä¸ºè¾“å…¥ã€‚æ”¯æŒç¼“å­˜ã€‚ç¼“å­˜ç”±listå’Œmapç»„åˆè€Œæˆã€‚BPTå…è®¸å¯å†™å…¥æ–‡ä»¶çš„å¹¶æ”¯æŒå¤§äºï¼Œå°äºï¼Œç­‰äºè¿ç®—ç¬¦çš„ç±»å‹ã€‚å¯ä»¥è°ƒèŠ‚æ¯ä¸ªå—ä¸­çš„å…ƒç´ ä¸ªæ•°ï¼Œå¯ä»¥è°ƒèŠ‚å—ä¸­å†—ä½™é‡å¤§å°ã€‚BPTç±»æ”¯æŒæ–‡ä»¶å›æ”¶ã€‚BPTæ”¯æŒæ’å…¥å’Œåˆ é™¤ï¼Œæ”¯æŒæŒ‰é”®å€¼æŸ¥æ‰¾å¤§äºæŸä¸ªå€¼çš„æ‰€æœ‰å…ƒç´ ï¼Œæ”¯æŒæŒ‰é”®å€¼æŸ¥æ‰¾å¤§äºæŸä¸ªå€¼ï¼Œå¹¶å°äºæŸä¸ªå€¼çš„å…ƒç´ ã€‚æ”¯æŒä¸€é”®æ¸…ç©ºã€‚æŸ¥æ‰¾çš„è¿”å›å¯¹è±¡æ˜¯ä¸€ä¸ªlist.

åœ¨memoryriver.hppä¸­ï¼Œæä¾›äº†ä¸€ä¸ªä¸å¤–å­˜äº¤äº’çš„å·¥å…·ã€‚å¯ä»¥å­˜å‚¨å¯å†™å…¥æ•°æ®ï¼Œå¹¶ä¸”å¯å­˜å‚¨å‚æ•°ã€‚

account.hppä¸­ï¼Œæä¾›äº†ä¸è´¦å·æœåŠ¡çš„ç›¸å…³åŠŸèƒ½ã€‚

utility.hppä¸­ï¼Œæä¾›äº†æ–‡æœ¬å¤„ç†åŠŸèƒ½ï¼Œexceptionï¼Œpairï¼Œå’Œä¸€ä¸ªæ—¶é—´ç±»ã€‚

train.hppä¸­ï¼Œæä¾›äº†å¯¹ç«è½¦ã€ç«è½¦ç¥¨åŠ¡çš„æŸ¥è¯¢å’Œç»´æŠ¤åŠŸèƒ½ã€‚

order.hppä¸­ï¼Œæä¾›äº†è´­ç¥¨ã€é€€ç¥¨ã€è®¢å•æŸ¥è¯¢åŠŸèƒ½ã€‚

## å­˜å‚¨æ–‡ä»¶ç»“æ„

account_index:è®°å½•äº†è´¦å·çš„å­˜å‚¨ç´¢å¼•å’Œæƒé™ã€‚

account_content:å¯¹è´¦å·çš„å…¨éƒ¨å†…å®¹è¿›è¡Œå­˜å‚¨ã€‚

order_user:å¯¹ç”¨æˆ·ä¸‹è¾¾çš„æ‰€æœ‰è®¢å•è¿›è¡Œå­˜å‚¨ã€‚

queue:å¯¹å€™è¡¥è®¢å•è¿›è¡Œå­˜å‚¨ã€‚

train_index:è®°å½•äº†è½¦æ¬¡çš„å­˜å‚¨ç´¢å¼•ã€‚

train_database:è®°å½•äº†è½¦è¾†çš„æ‰€æœ‰ä¿¡æ¯ã€‚

station:è®°å½•äº†ç»è¿‡æŸç«™ç‚¹çš„æ‰€æœ‰åˆ—è½¦ã€‚

train_day_index:è®°å½•äº†ç»è¿‡æŸç«™ç‚¹çš„ä¸åŒå‘è½¦æ—¶é—´çš„æ‰€æœ‰åˆ—è½¦çš„å­˜å‚¨ç´¢å¼•ã€‚

train_day_info:å­˜å‚¨äº†è¯¥è½¦æ¬¡ä»æ—§å…·æœ‰çš„ä½™ç¥¨é‡ã€‚

## ç±»å’Œå‡½æ•°è¯´æ˜

### Account.hpp

```cpp
void AddAccount(string &);//è¾“å…¥åˆæ³•å‘½ä»¤ï¼Œå³å¯ä»¥åˆ›å»ºè´¦å·ã€‚
void Login(string &);//è¾“å…¥åˆæ³•å‘½ä»¤è¿›è¡Œç™»å½•ã€‚
void Logout(string &);//è¾“å…¥åˆæ³•å‘½ä»¤è¿›è¡Œç™»å‡ºã€‚
std::string QueryAccount(string &);//æŸ¥è¯¢è´¦å·ã€‚å¦‚æœæƒé™åˆæ³•ï¼Œä¼šè¿”å›ä¸€ä¸ªå¸¦æœ‰æŸ¥è¯¢å¯¹è±¡çš„å­—ç¬¦ä¸²ã€‚
std::string ModifyAccount(string &);//ä¿®æ”¹è´¦å·ã€‚å¦‚æœæƒé™åˆæ³•ï¼Œä¼šè¿”å›ä¸€ä¸ªå¸¦æœ‰ä¿®æ”¹å¯¹è±¡çš„å­—ç¬¦ä¸²ã€‚
void AddFirstAccount(string &);//å¦‚æœæ²¡æœ‰è´¦æˆ·ï¼Œä¼šåˆ›å»ºç¬¬ä¸€ä¸ªè´¦æˆ·ã€‚

class AccountIndex;//è´¦å·çš„å­˜å‚¨ç´¢å¼•å’Œæƒé™ã€‚
class HashOfAccount;//è´¦å·çš„hashå€¼ã€‚
class Account;//è´¦å·çš„æ‰€æœ‰ä¿¡æ¯ã€‚
```

### BPT.hpp

```cpp
  template <class Value = int, int size = 168, int redundancy = 6, int cachesize = 400>
  //sizeæŒ‡ç¤ºå—çš„å¤§å°ä¸Šé™ã€‚redundancyç”¨äºæŒ‡ç¤ºå†—ä½™é‡ï¼Œä»è€Œä¿è¯å—å¤§å°ã€‚cachesizeç”¨äºæŒ‡å®šç¼“å­˜ä¸Šé™ã€‚
class BPT;//B+æ ‘å­˜å‚¨ç±»
BPT(std::string);//æ„é€ å‡½æ•°ï¼ŒæŒ‡å®šæ–‡ä»¶åã€‚
//åœ¨ä¸‹é¢å››ä¸ªå‡½æ•°ä¸­ï¼Œç¬¬ä¸€ä¸ªå’Œå‚æ•°å’Œç¬¬äºŒä¸ªå‚æ•°è¡¨ç¤ºä¸¤ä¸ªæœ‰é¡ºåºçš„hashå€¼ã€‚
//è¿™å››ä¸ªå‡½æ•°éƒ½æ˜¯BPTç±»çš„æˆå‘˜å‡½æ•°ã€‚
void insert(unsigned long long, unsigned long long, Value);//æ’å…¥
void erase(unsigned long long, unsigned long long, Value);//åˆ é™¤
sjtu::list<Value> find(unsigned long long, unsigned long long, Value);//æŸ¥æ‰¾å“ˆå¸Œå€¼ç›¸åŒï¼Œå¹¶ä¸”ä¸å°äºè¯¥Valueçš„æ‰€æœ‰å…ƒç´ ã€‚å°çš„å…ƒç´ åœ¨é“¾è¡¨å¤´ã€‚
sjtu::list<Value> find2(unsigned long long, unsigned long long, Value, Value);//æŸ¥æ‰¾å“ˆå¸Œå€¼ç›¸åŒï¼Œä¸å°äºç¬¬ä¸€ä¸ªValueï¼Œå¹¶ä¸”å°äºç¬¬äºŒä¸ªValueçš„å…ƒç´ ã€‚å°çš„å…ƒç´ åœ¨é“¾è¡¨å¤´ã€‚
```

### memoryriver.hpp

```cpp
template <class W, int info_len = 3> class MemoryRiver;
MemoryRiver(const std::string);//æ„é€ å‡½æ•°ï¼ŒæŒ‡å®šæ–‡ä»¶åã€‚
void ChangeName(std::string);//ç”¨äºæ›´åã€‚
void initialise();//ç”¨äºæ‰§è¡Œåˆå§‹åŒ–æ“ä½œã€‚
  // è¯»å‡ºç¬¬nä¸ªintçš„å€¼èµ‹ç»™tmpï¼Œ1_base
  void get_info(int &tmp, int n);

  // å°†tmpå†™å…¥ç¬¬nä¸ªintçš„ä½ç½®ï¼Œ1_base
  void write_info(int tmp, int n);

  // åœ¨æ–‡ä»¶åˆé€‚ä½ç½®å†™å…¥æˆ–è¯»å…¥ç±»å¯¹è±¡tï¼Œå¹¶è¿”å›å†™å…¥çš„ä½ç½®ç´¢å¼•index
  // ä½ç½®ç´¢å¼•æ„å‘³ç€å½“è¾“å…¥æ­£ç¡®çš„ä½ç½®ç´¢å¼•indexï¼Œåœ¨ä»¥ä¸‹ä¸‰ä¸ªå‡½æ•°ä¸­éƒ½èƒ½é¡ºåˆ©çš„æ‰¾åˆ°ç›®æ ‡å¯¹è±¡è¿›è¡Œæ“ä½œ
  // ä½ç½®ç´¢å¼•indexå¯ä»¥å–ä¸ºå¯¹è±¡å†™å…¥çš„èµ·å§‹ä½ç½®,1baseï¼Œsizeè¡¨ç¤ºä¸€æ¬¡æ€§è¯»å…¥å¤šå°‘ä¸ªWã€‚
  void write(W &t, int which_node, int size = 1);
  void read(W &t, int which_node, int size = 1);
  void clear();//æ¸…ç©ºæ‰€æœ‰å…ƒç´ ã€‚
```

### order.hpp

```cpp
class OrderByTrain;//å­˜å‚¨å€™è¡¥è®¢å•ä¿¡æ¯ã€‚
class OrderByUser;//å­˜å‚¨ç”¨æˆ·è®¢å•ä¿¡æ¯ã€‚
//ç”¨æˆ·è®¢å•å…·æœ‰ä¸€ä¸ªpublicå‡½æ•°ã€‚
void Print() const;//è¿™ä¼šæŒ‰ç…§è¦æ±‚æ‰“å°è®¢å•ä¿¡æ¯ã€‚
void QueryOrder(std::string &);//æŸ¥è¯¢è®¢å•æƒ…å†µå¹¶æ‰“å°ã€‚
void Buy(std::string &, const int);//è´­ç¥¨ã€‚ç¬¬äºŒä¸ªå‚æ•°æ˜¯æ—¶é—´æˆ³ã€‚
void Refund(std::string &);//é€€ç¥¨
```

### train.hpp

```cpp
class TrainDayIndex;//è®°å½•äº†æ¯è½¦æ¬¡æ¯å¤©çš„ç¥¨åŠ¡æƒ…å†µçš„å­˜å‚¨ç´¢å¼•ã€‚
class AskData;//è®°å½•æŸæ—¥è½¦æ¬¡å¾…æŸ¥è¯¢æƒ…å†µã€‚
class TransferData;//è®°å½•æ¢ä¹˜æ–¹æ¡ˆã€‚
class TrainInfo;//è®°å½•è½¦æ¬¡çš„æ‰€æœ‰ä¿¡æ¯ã€‚
//TrainInfoç±»å…·æœ‰è¾ƒå¤šçš„æˆå‘˜å‡½æ•°ã€‚ä¸‹åˆ—å‡½æ•°å‡æ˜¯ã€‚
bool IsReleased() const;//æ˜¯å¦å·²å‘å¸ƒã€‚
int FindIndex(const char *) const;//æŸ¥æ‰¾ç«™åå¯¹åº”çš„indexã€‚
int AskPrice(const int &, const int &) const;//è¯¢é—®ä¸¤ä¸ªç«™ç‚¹ä¹‹é—´çš„è´¹ç”¨ã€‚
Time AskOutTime(const int &index, const int &month, const int &day) const;
//è¯¢é—®æŸæ—¥åˆ°è¾¾æŸç«™çš„åˆ—è½¦çš„å‘è½¦æ—¶é—´ã€‚
bool IsSaleTime(const int &, const int &) const;//è¯¢é—®æ˜¯å¦åœ¨å‘å”®æ—¶é—´å†…ã€‚
Time AskLeaveTime(const int &index, const int &, const int &) const;
//è¯¢é—®æŸæ—¥å‘è½¦çš„åˆ—è½¦ä½•æ—¶ç¦»å¼€æŸç«™ã€‚
Time AskArriveTime(const int &index, const int &, const int &) const;
//è¯¢é—®æŸæ—¥åˆ°è¾¾çš„åˆ—è½¦ä½•æ—¶åˆ°è¾¾æŸç«™ã€‚
bool CheckAvailable(const Time &) const;
//æ£€æŸ¥æ—¶é—´æ—¶å€™åœ¨å‘å”®æ—¶é—´å†…ã€‚
int AskTime(const int &, const int &) const;
//è¯¢é—®ä¸¤ä¸ªç«™ç‚¹é—´æ‰€è¦èŠ±è´¹çš„æ—¶é—´ã€‚
class TrainDay;//è®°å½•æŸæ—¥æŸç­è½¦çš„ç¥¨åŠ¡æƒ…å†µã€‚
//ä»¥ä¸‹æ˜¯å››ä¸ªæ’åºä»¿å‡½æ•°ã€‚
class SortTrainByCost;
class CompareTransferByCost;
class SortTrainByTime;
class CompareTransferByTime;

void AddTrain(string &);//æ·»åŠ åˆ—è½¦ã€‚
void ReleaseTrain(string &);//å‘å¸ƒåˆ—è½¦ã€‚
void DeleteTrain(string &);//åˆ é™¤åˆ—è½¦ã€‚
void QueryTrain(string &);//æŸ¥è¯¢åˆ—è½¦ã€‚
void QueryTicket(string &);//æŸ¥è¯¢ç¥¨åŠ¡ã€‚
void QueryTransfer(string &);//æŸ¥è¯¢æ¢ä¹˜æ–¹æ¡ˆã€‚
```

### utility.hpp
```cpp
class exception;//å¼‚å¸¸å¤„ç†ç±»ã€‚
exception(std::string);//æ„é€ å‡½æ•°ã€‚
class Time;//æ—¶é—´ç±»ã€‚ä¸‹åˆ—ä¸ºå…¶æˆå‘˜å‡½æ•°ã€‚
void Add(const int &);//åœ¨å½“å‰åŸºç¡€ä¸ŠåŠ ä¸Šå¤šå°‘åˆ†é’Ÿã€‚
void Minus(const int &);//åœ¨å½“å‰åŸºç¡€ä¸Šå‡å»å¤šå°‘åˆ†é’Ÿã€‚
void Print() const;//æ‰“å°æ—¶é—´ã€‚
int GetMonth() const;//è¿”å›æœˆä»½ã€‚
int GetDay() const;//è¿”å›æ—¥æœŸã€‚

int IntervalMinute(Time, Time);//è¯¢é—®ä¸¤ä¸ªæ—¶é—´ä¹‹é—´é—´éš”çš„æ—¶é—´æ•°ã€‚
std::string ProcessTxt(std::string &);//å°†å­—ç¬¦ä¸²åœ¨ç©ºæ ¼å¤„æˆªæ–­ã€‚
std::string ProcessMalValue(std::string &);//å°†å­—ç¬¦ä¸²åœ¨'|'å¤„æˆªæ–­ã€‚
template <class T1, class T2> class pair;//å¼•ç”¨è‡ªACM_STLiteåº“ã€‚æ¨¡æ‹Ÿpairçš„è¡Œä¸ºã€‚
template <class T> class Less;//æ¨¡æ‹Ÿstd::less<T>
inline unsigned long long MyHash(const std::string &,
const unsigned long long &);//æ–‡æœ¬hashå€¼è®¡ç®—ã€‚
```
